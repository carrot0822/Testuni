(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/option/option"],{"0d1b":function(t,e,o){"use strict";o.r(e);var n=o("3cc3"),a=o.n(n);for(var i in n)"default"!==i&&function(t){o.d(e,t,function(){return n[t]})}(i);e["default"]=a.a},"1be0":function(t,e,o){},"3cc3":function(t,e,o){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s(o("a34a")),i=s(o("3ba7"));function s(t){return t&&t.__esModule?t:{default:t}}function r(t,e,o,n,a,i,s){try{var r=t[i](s),u=r.value}catch(l){return void o(l)}r.done?e(u):Promise.resolve(u).then(n,a)}function u(t){return function(){var e=this,o=arguments;return new Promise(function(n,a){var i=t.apply(e,o);function s(t){r(i,n,a,s,u,"next",t)}function u(t){r(i,n,a,s,u,"throw",t)}s(void 0)})}}var l={data:function(){return{tabInd:0,statusBarHeight:0,bodyHeight:0,state:"",isLocked:!0,storeroomArray:[],storeroomIndex:0,storeroomNum:0,storerooms:[],regions:[],regionArray:[],regionIndex:0,regionNum:0,cols:[],colIndex:0,direction:"",curState:"",isMove:!1,hjz:{wd:0,sd:0,co2:0,ch20:0,pm10:0,pm25:0,tvoc:0},timeer:null,hasPerson:!1,requestIp:""}},watch:{storeroomNum:function(e,o){t.setStorage({key:"fkStoredId",data:e,success:function(){}})},requestIp:function(t,e){n("log",t,"每次Ip变动"," at pages\\option\\option.vue:267"),this._bindIp()}},onLoad:function(){this.statusBarHeight=t.getSystemInfoSync()["statusBarHeight"],this.bodyHeight=t.getSystemInfoSync()["windowHeight"]-this.statusBarHeight-48;var e=t.getStorageSync("storeroomIndex");e?(n("log",e,"库房值存在的话"," at pages\\option\\option.vue:279"),this.storeroomIndex=e):t.setStorageSync("storeroomIndex",0);var o=t.getStorageSync("regionIndex");o?(n("log",o,"值存在的话"," at pages\\option\\option.vue:286"),this.regionIndex=o):t.setStorageSync("regionIndex",0);var a=t.getStorageSync("colIndex");a?this.colIndex=a:t.setStorageSync("colIndex",0)},onShow:function(){clearInterval(this.timeer),this.timeer=null,this.selectStoreRoom(),n("log","调试定时器"," at pages\\option\\option.vue:308"),this.colIndex=t.getStorageSync("colIndex"),this.regionIndex=t.getStorageSync("regionIndex")},onHide:function(){n("log",this.timeer,"编译器"," at pages\\option\\option.vue:314"),clearInterval(this.timeer),this.timeer=null,n("log",this.timeer,"定时器没关掉吗"," at pages\\option\\option.vue:317")},methods:{onPageJump:function(){t.navigateTo({url:"../search/search"})},checkCache:function(){},scrollL:function(e){var o=this,n=e.detail.scrollLeft,a=t.createSelectorQuery().in(this);a.select(".temp_shelf .item_box").boundingClientRect(function(t){var e=Math.floor(n/(3*t.width));o.tabInd=e}).exec()},upper:function(t){this.tabInd=0},lower:function(t){this.tabInd=1},selectStoreRoom:function(){var t=this;t.submitAjax("environmentmodule/wkStoTbStore/selectWkStoTbStore",null,"GET",function(e){t.storeroomArray=[],t.storerooms=e.data.rows;var o=!0,a=!1,i=void 0;try{for(var s,r=e.data.rows[Symbol.iterator]();!(o=(s=r.next()).done);o=!0){var u=s.value;t.storeroomArray.push(u.storeName)}}catch(c){a=!0,i=c}finally{try{o||null==r.return||r.return()}finally{if(a)throw i}}var l=t.storeroomIndex;n("log",l,"取到了吧"," at pages\\option\\option.vue:353"),t.storeroomNum=e.data.rows[l].id,t.selectRegion(t.storeroomNum)})},storeroomChange:function(e){var o=this;o.storeroomNum=o.storerooms[e.target.value].id,o.storeroomIndex=e.target.value,t.setStorageSync("storeroomIndex",e.target.value),this.colIndex=0,this.regionIndex=0,t.setStorageSync("regionIndex",0),t.setStorageSync("colIndex",0),o.selectRegion(o.storeroomNum)},selectRegion:function(t){var e=this;clearInterval(this.timeer),this.timeer=null,n("log","只打开一个定时器",this.timeer," at pages\\option\\option.vue:378"),e.submitAjax("storeroommodule/stoTbRegion/selectByBind?fkStoreId="+t,null,"GET",function(t){e.regionArray=[],e.regions=t.data.rows;var o=!0,a=!1,i=void 0;try{for(var s,r=e.regions[Symbol.iterator]();!(o=(s=r.next()).done);o=!0){var u=s.value;e.regionArray.push(u.regionName)}}catch(c){a=!0,i=c}finally{try{o||null==r.return||r.return()}finally{if(a)throw i}}var l=e.regionIndex;e.regionNum=t.data.rows[l].regionNum,e.getCols(e.regionNum),e.requestIp=e.regions[l].reqestIp,n("log",e.regions[l].reqestIp,"每次改变都需要改动IP传给后台"," at pages\\option\\option.vue:390"),e.timeer=setInterval(function(){e.timingGetState(),n("log","定时器没关上吗"," at pages\\option\\option.vue:395")},3e3)})},regionChange:function(e){var o=this;o.regionNum=o.regions[e.target.value].regionNum;var a=e.target.value;o.regionIndex=e.target.value,t.setStorage({key:"regionIndex",data:e.target.value,success:function(){n("log","success 存储区号",e.target.value," at pages\\option\\option.vue:409")}}),n("log",o.regionIndex,o.regionNum,"到底哪个是索引"," at pages\\option\\option.vue:412"),o.requestIp=o.regions[a].reqestIp,n("log",this.regions[a].reqestIp," at pages\\option\\option.vue:415"),o.getCols(o.regionNum)},getCols:function(t){var e=this;e.cols=[];var o={},a=!0,i=!1,s=void 0;try{for(var r,u=e.regions[Symbol.iterator]();!(a=(r=u.next()).done);a=!0){var l=r.value;if(l.regionNum==t){o=l;break}}}catch(d){i=!0,s=d}finally{try{a||null==u.return||u.return()}finally{if(i)throw s}}for(var c=1;c<=o.cols;c++){if(("left"==o.gdlType||"right"==o.gdlType)&&c==o.cols)break;e.cols.push(c)}n("log",this.regions,"查询区数据"," at pages\\option\\option.vue:437"),e.colNum=e.cols[0]},colChange:function(e){var o=this;o.colNum=o.cols[e.target.value],o.colIndex=e.target.value,t.setStorage({key:"colIndex",data:e.target.value,success:function(){n("log","success 存储列号",e.target.value," at pages\\option\\option.vue:448")}})},timingGetState:function(){var t=this,e=t.regionNum;t.submitAjax("denseShelves/getstates?quNum="+e,null,"POST",function(e){if(e.data.state&&e.data.row){var o=JSON.parse(e.data.row),a=Number(o.personCount);n("log",typeof a,a,"数据格式"," at pages\\option\\option.vue:460"),t.state=o.message;var i=["正在左移中","正在右移中","解除"],s=["禁止","锁定","到位","机械锁定","停止","门禁"];t.hasPerson=!!a,n("log","有人mua",t.hasPerson," at pages\\option\\option.vue:471"),i.includes(o.message)?t.isLocked=!1:s.includes(o.message)&&(t.isLocked=!0),"禁止"!=t.state&&"锁定"!=t.state&&"到位"!=t.state&&"机械锁定"!=t.state&&"停止"!=t.state||(t.isMove=!1),"正在右移中"!=t.state&&"正在左移中"!=t.state||(t.isMove=!0)}}),t.getGethumiture(e)},getGethumiture:function(t){var e=this;e.submitAjax("countmodule/storeAndRegionCount/getNewHumiture?quNum="+t,null,"POST",function(t){if(t.data.state&&t.data.row){var o=t.data.row;e.hjz.wd=o.wd.toFixed(1)?o.wd.toFixed(1):0,e.hjz.sd=o.sd.toFixed(1)?o.sd.toFixed(1):0,e.hjz.tvoc=o.tvoc.toFixed(1)?o.tvoc.toFixed(1):0,e.hjz.co2=o.co2.toFixed(1)?o.co2.toFixed(1):0,e.hjz.ch20=o.ch20.toFixed(1)?o.ch20.toFixed(1):0,e.hjz.pm10=o.pm10.toFixed(1)?o.pm10.toFixed(1):0,e.hjz.pm25=o.pm25.toFixed(1)?o.pm25.toFixed(1):0}})},locked:function(){var e=this,o=e.regionNum;e.isLocked?e.submitAjax("denseShelves/Unlock?quNum="+o,null,"POST",function(o){if(o.data.state&&o.data.row){JSON.parse(o.data.row);e.isLocked=!1,t.showToast({title:"解锁成功",duration:2e3})}else t.showModal({title:"提示",content:o.data.msg,showCancel:!1,success:function(t){}})}):e.submitAjax("denseShelves/locking?quNum="+o,null,"POST",function(o){if(o.data.state&&o.data.row){JSON.parse(o.data.row);e.isLocked=!0,t.showToast({title:"锁定成功",duration:2e3})}else t.showModal({title:"提示",content:o.data.msg,showCancel:!1,success:function(t){}})})},opTask:function(){var e=this;e.submitAjax("denseShelves/openshelf?quNum="+e.regionNum,null,"POST",function(e){e.data.state&&e.data.row||t.showModal({title:"提示",content:e.data.msg,showCancel:!1})})},closeTask:function(){var e=this;e.hasPerson?t.showModal({title:"提示",content:"密集架内有人,无法移动密集架",showCancel:!1}):e.submitAjax("denseShelves/merge?quNum="+e.regionNum,null,"POST",function(o){o.data.state&&o.data.row?(t.showToast({title:"正在合架",duration:2e3}),e.isLocked):t.showModal({title:"提示",content:o.data.msg,showCancel:!1,success:function(t){t.confirm?n("log","用户点击确定"," at pages\\option\\option.vue:602"):t.cancel&&n("log","用户点击取消"," at pages\\option\\option.vue:604")}})})},ventilation:function(){var e=this;e.submitAjax("denseShelves/aeration?quNum="+e.regionNum,null,"POST",function(o){o.data.state&&o.data.row?(t.showToast({title:"正在通风",duration:2e3}),e.isLocked):t.showModal({title:"提示",content:o.data.msg,showCancel:!1,success:function(t){t.confirm?n("log","用户点击确定"," at pages\\option\\option.vue:631"):t.cancel&&n("log","用户点击取消"," at pages\\option\\option.vue:633")}})})},left:function(){var e=this;e.hasPerson?t.showModal({title:"提示",content:"密集架内有人,无法移动密集架",showCancel:!1}):e.isLocked?t.showModal({title:"提示",content:"密集架已被锁定 请先解除锁定",showCancel:!1}):e.submitAjax("denseShelves/leftmove?quNum="+e.regionNum+"&column="+e.colNum,null,"POST",function(e){e.data.state&&e.data.row?t.showToast({title:"正在左移",duration:2e3}):t.showModal({title:"提示",content:e.data.msg,showCancel:!1})})},stop:function(){var e=this;e.isMove=!1,e.submitAjax("denseShelves/stop?quNum="+e.regionNum,null,"POST",function(o){o.data.state&&o.data.row?(t.showToast({title:"正在停止",duration:2e3}),e.isLocked):t.showModal({title:"提示",content:o.data.msg,showCancel:!1,success:function(t){t.confirm?n("log","用户点击确定"," at pages\\option\\option.vue:703"):t.cancel&&n("log","用户点击取消"," at pages\\option\\option.vue:705")}})})},right:function(){var e=this;e.hasPerson?t.showModal({title:"提示",content:"密集架内有人,无法移动密集架",showCancel:!1}):e.isLocked?t.showModal({title:"提示",content:"密集架已被锁定 请先解除锁定",showCancel:!1}):e.submitAjax("denseShelves/rightmove?quNum="+e.regionNum+"&column="+e.colNum,null,"POST",function(e){e.data.state&&e.data.row?t.showToast({title:"正在右移",duration:2e3}):t.showModal({title:"提示",content:e.data.msg,showCancel:!1})})},openFrame:function(){var t=this.regionIndex,e=this.regions[t].gdlType;n("warn",this.regionArray[t],e,"密集架所在区和位置"," at pages\\option\\option.vue:758"),"右边"==e?this.leftMove():this.rightMove()},rightMove:function(){var t=this;this._jugeState().then(function(){n("log","这个right执行"," at pages\\option\\option.vue:773"),t.right()})},leftMove:function(){var t=this;this._jugeState().then(function(){n("log","这个left执行"," at pages\\option\\option.vue:779"),t.left()})},_jugeState:function(){var t=u(a.default.mark(function t(){var e,o,s,r,u;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.regionNum,t.next=3,(0,i.default)(this.$mjjUrl+"denseShelves/getstates?quNum="+e,null,"POST");case 3:o=t.sent,s=JSON.parse(o.data.row),r=["正在左移中","正在右移中","解除"],u=["禁止","锁定","到位","机械锁定","停止","门禁"],r.includes(s.message)?this.isLocked=!1:u.includes(s.message)&&(this.isLocked=!0),n("log","这个先执行"," at pages\\option\\option.vue:800");case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),_bindIp:function(){var e=this.requestIp;(0,i.default)(this.$mjjUrl+"denseShelves/configIp?ip=".concat(e),null,"POST").then(function(e){e.data.state?n("log",e,"测试数据是这样的吗"," at pages\\option\\option.vue:807"):(t.showToast({title:e.data.msg,duration:2e3}),n("log","配置失败"," at pages\\option\\option.vue:813"))})}}};e.default=l}).call(this,o("6e42")["default"],o("0de9")["default"])},5324:function(t,e,o){"use strict";var n,a=function(){var t=this,e=t.$createElement;t._self._c},i=[];o.d(e,"b",function(){return a}),o.d(e,"c",function(){return i}),o.d(e,"a",function(){return n})},"55e1":function(t,e,o){"use strict";o.r(e);var n=o("5324"),a=o("0d1b");for(var i in a)"default"!==i&&function(t){o.d(e,t,function(){return a[t]})}(i);o("af6f");var s,r=o("f0c5"),u=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=u.exports},af6f:function(t,e,o){"use strict";var n=o("1be0"),a=o.n(n);a.a},da49:function(t,e,o){"use strict";(function(t){o("f821"),o("921b");n(o("66fd"));var e=n(o("55e1"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("6e42")["createPage"])}},[["da49","common/runtime","common/vendor"]]]);